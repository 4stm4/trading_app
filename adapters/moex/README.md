# MOEX Adapter

Техническая документация по адаптеру MOEX (ISS).
Пользовательский CLI описан отдельно: `python -m ports.cli.trading_cli`.

## Назначение

`adapters/moex` содержит только интеграцию с MOEX и подготовку данных.
Торговая логика, сигналы, риск-менеджмент и бэктест находятся в `services/strategy_engine`.

## Модули

```text
adapters/moex/
├── iss_client.py          # Клиент MOEX ISS API (свечи, котировки, спецификация инструмента)
├── indicator_dataset.py   # OHLCV -> DataFrame + индикаторы (через services.strategy_engine.indicators)
├── cli_dataset_loader.py  # Обертка для CLI: загрузка + quality warnings
├── setup_monitor.py       # MOEX price feed для мониторинга активных сетапов
└── data_probe_cli.py      # Диагностическая утилита просмотра данных
```

## Границы слоя

- Допустимо в адаптере: запросы к MOEX ISS.
- Допустимо в адаптере: трансформация ответа API в табличные данные.
- Допустимо в адаптере: передача данных в core/сервисы.
- Не должно быть в адаптере: правил стратегии.
- Не должно быть в адаптере: моделей/оптимизации/бэктеста.
- Не должно быть в адаптере: универсального CLI приложения.

## Быстрые команды

Проверка данных напрямую из адаптера:

```bash
python -m adapters.moex.data_probe_cli SBER -t 1h
```

Основной CLI системы:

```bash
python -m ports.cli.trading_cli --help
```

Примечание по диапазону данных:

- Если `--start-date/--end-date` не указаны, CLI автоматически запрашивает увеличенный объем свечей
  (целевой минимум для статистики), а не фиксированные 30 дней.
- Для полного контроля всегда задавайте даты явно.
